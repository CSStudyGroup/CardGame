<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <th:block th:replace="fragment/head::headFragment"></th:block>
    <link rel="stylesheet" th:href="@{/css/list.css(ver=${#calendars.createNow()})}">
    <script defer th:src="@{/js/list.js(ver=${#calendars.createNow()})}"></script>
</head>
<body>
    <div th:switch="${role}">
        <div th:case="'admin'"><th:block th:replace="fragment/navigator-admin::navigator-admin(title='List')"></th:block></div>
        <div th:case="'user'"><th:block th:replace="fragment/navigator-user::navigator-user(title='List', role='user')"></th:block></div>
        <div th:case="*"><th:block th:replace="fragment/navigator-user::navigator-user(title='List', role='guest')"></th:block></div>
    </div>
    <div class="main">
        <div class="container">
            <table class="table">
                <tr class="head">
                    <th width="10%">ID</th>
                    <th width="30%">Category</th>
                    <th width="60%">Question</th>
                    <th th:width="45px" class="no-line"></th>
                    <th th:width="35px" class="no-line"></th>
                </tr>
                <tr class="tableBody" th:each="cardDto : ${cardDtoList}">
                    <td class="underline id"
                        th:text="${cardDto.id}"></td>
                    <td class="underline category"
                        th:text="${cardDto.cid}"></td>
                    <td class="underline question clickable"
                        th:attr="onclick=|text('${cardDto.id}')|"
                        th:text="${cardDto.question}"></td>
                    <td class="update">
                        <img class="clickable" height="30px" width="auto" style="margin-left: 10px"
                             th:attr="onclick=|update('${cardDto.id}')|"
                             th:src="@{/img/edit_image.png}">
                    </td>
                    <td class="delete">
                        <img class="clickable" height="30px" width="auto"
                             th:attr="onclick=|del('${cardDto.id}')|"
                             th:src="@{/img/delete_image.png}">
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div th:replace="fragment/modal::modalFragment(modalId='modal-view',
        title=~{::.modal-view-title},
        content=~{::.modal-view-content},
        buttons=~{::.modal-view-buttons},
        closeButton=false,
        escClose=true,
        outClose=true)">
        <th:block class="modal-view-title">
            <a class="modal-title-text" id="modal-view-title-text"></a>
        </th:block>
        <th:block class="modal-view-content">
            <a class="modal-content-category" id="modal-view-content-category"></a>

            <a class="modal-content-title modal-title-question">Q.</a>
            <textarea disabled="true" class="modal-content-textarea"
                      id="modal-view-content-question"></textarea>
            <a class="modal-content-title modal-title-answer">A.</a>
            <textarea disabled="true" class="modal-content-textarea"
                      id="modal-view-content-answer"></textarea>
            <a class="modal-content-title modal-title-tags">T.</a>
            <textarea disabled="true" class="modal-content-textarea"
                      id="modal-view-content-tags"></textarea>
        </th:block>
        <th:block class="modal-view-buttons">
            <button class="clickable" type="button"
                    onclick="viewModalClose()">닫기</button>
        </th:block>
    </div>
    <div th:replace="fragment/modal::modalFragment(modalId='modal-update',
        title=~{::.modal-update-title},
        content=~{::.modal-update-content},
        buttons=~{::.modal-update-buttons},
        closeButton=false,
        escClose=true)">
        <th:block class="modal-update-title">
            <a class="modal-title-text" id="modal-update-title-text"></a>
        </th:block>
        <th:block class="modal-update-content">
            <form class="modal-content-category" id="modal-update-content-category">
                <form id="modal-insert-content-category">
                    <div th:replace="fragment/selectbox::selectBoxFragment(selectBoxId='modal-update-content-category-select',
                    optionList=${ categoryDtoList },
                    optionText='name',
                    optionValue='id')"></div>
                </form>
            </form>
            <a class="modal-content-title modal-title-question">Q.</a>
            <textarea maxlength="200" class="modal-content-textarea"
                      id="modal-update-content-question"></textarea>
            <a class="modal-content-title modal-title-answer">A.</a>
            <textarea onkeydown="if(event.keyCode===9){
                let v=this.value,s=this.selectionStart,e=this.selectionEnd;
                this.value=v.substring(0, s)+'\t'+v.substring(e);
                this.selectionStart=this.selectionEnd=s+1;
                return false;
            }" maxlength="1000" class="modal-content-textarea"
                      id="modal-update-content-answer"></textarea>
            <a class="modal-content-title modal-title-tags">T.</a>
            <textarea maxlength="210" class="modal-content-textarea"
                      id="modal-update-content-tags"></textarea>
        </th:block>
        <th:block class="modal-update-buttons">
            <button class="clickable" type="button"
                    onclick="updateModalSubmit()">수정</button>
            <button class="clickable" type="button"
                    onclick="updateModalClose()">닫기</button>
        </th:block>
    </div>
    <div th:replace="fragment/modal::modalFragment(modalId='modal-delete',
        title=~{::.modal-delete-title},
        buttons=~{::.modal-delete-buttons},
        closeButton=false,
        escClose=true,
        outClose=true)">
        <th:block class="modal-delete-title">
            <p class="delete-caution"></p>
        </th:block>
        <th:block class="modal-delete-buttons">
            <button class="remove clickable" type="reset">삭제</button>
            <button class="cancel clickable" type="reset">취소</button>
        </th:block>
    </div>
    <script th:inline="javascript">
        let dto = [[${cardDtoList}]];
        let criteria = [[${criteria}]];
        let keyword = [[${keyword}]];
        let original = [[${original}]];
        let role = [[${role}]];
    </script>
</body>
</html>